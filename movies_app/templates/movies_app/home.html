{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MovieMind | Home</title>
    <link rel="stylesheet" href="{% static 'movies_app/home_style.css' %}">
</head>
<body>

<!-- üî∏ Navigation -->
<nav class="navbar">
    <div class="nav-left">
        <span class="menu-icon">‚ò∞</span>
        <span class="brand">MovieMind</span>
    </div>

    <div class="nav-center">
        <form action="#" method="get" class="search-form">
            <input type="text" name="q" placeholder="Search movies...">
            <button type="submit">üîç</button>
        </form>
    </div>

    <div class="nav-right">
        <a href="{% url 'watchlist' %}" class="watchlist">üîñ Watchlist</a>
        <span class="user">üë§ {{ user.username }}</span>
        <a href="{% url 'logout' %}">Logout</a>
    </div>
</nav>

<!-- üîπ Sidebar Menu -->
<div id="sidebar" class="sidebar">
    <ul>
        <li><a href="{% url 'home' %}">üè† Home</a></li>
        <li><a href="{% url 'liked_movies' %}">‚ù§Ô∏è Liked Movies</a></li>
        <li><a href="#">ü§ñ ML</a></li>
    </ul>
</div>

<!-- üîπ Trending Movies -->
<div class="section">
    <h2>üî• Trending This Week</h2>
    <div class="movie-list">
        {% for movie in trending %}
            <div class="movie-card">
                <img src="{% if movie.poster_path %}https://image.tmdb.org/t/p/w300{{ movie.poster_path }}{% else %}{% static 'movies_app/default_poster.jpg' %}{% endif %}" alt="{{ movie.display_title }}">
                <h4>{{ movie.display_title }}</h4>
                <div class="rating-circle">{{ movie.display_rating }}</div>
                <div class="action-buttons">
                    <form method="post" action="{% url 'like_movie' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="like-btn" title="Like">‚ù§Ô∏è</button>
                    </form>

                    <form method="post" action="{% url 'add_to_watchlist' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="watchlist-btn" title="Add to Watchlist">‚ûï</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<!-- üîπ Now Playing -->
<div class="section">
    <h2>üé¨ Now Playing</h2>
    <div class="movie-list">
        {% for movie in now_playing %}
            <div class="movie-card">
                <img src="{% if movie.poster_path %}https://image.tmdb.org/t/p/w300{{ movie.poster_path }}{% else %}{% static 'movies_app/default_poster.jpg' %}{% endif %}" alt="{{ movie.display_title }}">
                <h4>{{ movie.display_title }}</h4>
                <div class="rating-circle">{{ movie.display_rating }}</div>
                <div class="action-buttons">
                    <form method="post" action="{% url 'like_movie' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="like-btn" title="Like">‚ù§Ô∏è</button>
                    </form>

                    <form method="post" action="{% url 'add_to_watchlist' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="watchlist-btn" title="Add to Watchlist">‚ûï</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<!-- üîπ Upcoming -->
<div class="section">
    <h2>üîÆ Upcoming Movies</h2>
    <div class="movie-list">
        {% for movie in upcoming %}
            <div class="movie-card">
                <img src="{% if movie.poster_path %}https://image.tmdb.org/t/p/w300{{ movie.poster_path }}{% else %}{% static 'movies_app/default_poster.jpg' %}{% endif %}" alt="{{ movie.display_title }}">
                <h4>{{ movie.display_title }}</h4>
                <div class="rating-circle">{{ movie.display_rating }}</div>
                <div class="action-buttons">
                    <form method="post" action="{% url 'like_movie' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="like-btn" title="Like">‚ù§Ô∏è</button>
                    </form>

                    <form method="post" action="{% url 'add_to_watchlist' %}">
                        {% csrf_token %}
                        <input type="hidden" name="movie_id" value="{{ movie.id }}">
                        <input type="hidden" name="title" value="{{ movie.display_title }}">
                        <input type="hidden" name="poster_path" value="{{ movie.poster_path }}">
                        <input type="hidden" name="vote_average" value="{{ movie.display_rating }}">
                        <button type="submit" class="watchlist-btn" title="Add to Watchlist">‚ûï</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<!-- JS to toggle sidebar -->
<script>
    const menuIcon = document.querySelector('.menu-icon');
    const sidebar = document.getElementById('sidebar');
    menuIcon.addEventListener('click', () => {
        sidebar.classList.toggle('show');
    });
</script>

</body>
</html>
